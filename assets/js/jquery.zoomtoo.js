(function(){var t,e;t=window.jQuery,(e=function(t,e){this.element=t,this.load(e)}).defaults={showDuration:500,moveDuration:1200,magnify:1,lensWidth:200,lensHeight:200},e.prototype={load:function(e){var i;i=this.element.find("img").first().data("src"),this.element.one("zoomtoo.destroy",t.proxy(this.destroy,this)),i&&(this.img=new Image,this.img.src=i,this.img.onload=t.proxy(this.init,this,e))},init:function(i){var o;o=this.element.css("position"),this.settings=t.extend({},e.defaults,i),this.element.get(0).style.position=/(absolute|fixed)/.test(o)?o:"relative",this.element.get(0).style.overflow="hidden",this.elementWidth=this.element.outerWidth(),this.elementHeight=this.element.outerHeight(),this.imgWidth=this.img.width*this.settings.magnify,this.imgHeight=this.img.height*this.settings.magnify,this.elementOffset=this.element.offset(),this.newZoom={left:0,top:0},this.currentZoom={left:0,top:0},this.moveImageTimer=0,this.continueSlowMove=!1,this.prepareElements()},prepareElements:function(){t(this.img).css({position:"absolute",top:0,left:0,opacity:0,width:this.imgWidth,height:this.imgHeight,border:"none",maxWidth:"none",maxHeight:"none"}).appendTo(this.element),this.element.css({cursor:"crosshair"}).on("mouseenter.zoomtoo",t.proxy(this.mouseEnter,this)).on("mouseleave.zoomtoo",t.proxy(this.mouseLeave,this)).on("mousemove.zoomtoo",t.proxy(this.mouseMove,this))},destroy:function(){this.cancelTimer(),this.element.off(),t(this.img).remove(),this.element.removeData("zoomtoo")},calculateOffset:function(t){var e,i,o,s,h,n,m,l,r;e=t.x-this.elementOffset.left,h=(i=t.y-this.elementOffset.top)+(o=Math.round(this.settings.lensHeight/2)),n=e-(s=Math.round(this.settings.lensWidth/2)),m=e+s,i-o<0&&(i=o),h>this.elementHeight&&(i=this.elementHeight-o),n<0&&(e=s),m>this.elementWidth&&(e=this.elementWidth-s),r=-(this.imgHeight-this.elementHeight)/(this.elementHeight-this.settings.lensHeight)*(i-o),l=-(this.imgWidth-this.elementWidth)/(this.elementWidth-this.settings.lensWidth)*(e-s),this.newZoom.left=l,this.newZoom.top=r},cancelTimer:function(){clearTimeout(this.moveImageTimer)},stopSlowMoveImage:function(){this.continueSlowMove=!1},mouseLeave:function(){t(this.img).stop().fadeTo(this.settings.showDuration,0).promise().done(this.stopSlowMoveImage)},mouseEnter:function(e){var i;i={x:e.pageX,y:e.pageY},this.calculateOffset(i),this.continueSlowMove=!0,this.currentZoom.top=this.newZoom.top,this.currentZoom.left=this.newZoom.left,this.moveImage(),t(this.img).stop().fadeTo(this.settings.showDuration,1)},mouseMove:function(t){var e;e={x:t.pageX,y:t.pageY},this.calculateOffset(e),this.cancelTimer(),this.continueSlowMove=!0,this.slowMoveImage()},slowMoveImage:function(){var e,i,o,s;i={left:0,top:0},o=!1,s=!1,(e={left:0,top:0}).left=this.newZoom.left-this.currentZoom.left,e.top=this.newZoom.top-this.currentZoom.top,i.left=-e.left/(this.settings.moveDuration/100),i.top=-e.top/(this.settings.moveDuration/100),this.currentZoom.left=this.currentZoom.left-i.left,this.currentZoom.top=this.currentZoom.top-i.top,Math.abs(e.left)<1&&(this.currentZoom.left=this.newZoom.left,o=!0),Math.abs(e.top)<1&&(this.currentZoom.top=this.newZoom.top,s=!0),this.moveImage(),o&&s&&(this.continueSlowMove=!1),!0===this.continueSlowMove&&(this.moveImageTimer=setTimeout(t.proxy(this.slowMoveImage,this),25))},moveImage:function(){this.img.style.left=this.currentZoom.left+"px",this.img.style.top=this.currentZoom.top+"px"}},t.fn.zoomToo=function(i){this.each(function(){t.data(this,"zoomtoo")||t.data(this,"zoomtoo",new e(t(this),i))})}}).call(this);